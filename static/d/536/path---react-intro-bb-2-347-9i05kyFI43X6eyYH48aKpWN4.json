{"data":{"site":{"siteMetadata":{"title":"Vincent's page","author":"Vincent Cordobes"}},"markdownRemark":{"id":"2db1f4ed-e3b1-57e0-8cae-bd16730d845d","html":"<p><em>‚ö† Ce post a √©t√© r√©dig√© en 2016. Certaines choses ont √©volu√© depuis‚Ä¶</em></p>\n<p>React est une biblioth√®que javascript permettant de <strong>construire des interfaces graphiques composables</strong>. </p>\n<p>La mod√©lisation des interfaces graphiques d‚Äôune application au cours du temps est un sujet complexe. Il est, en effet, difficile de suivre l‚Äô√©tat d‚Äôune application, apr√®s une s√©rie d‚Äôinteractions utilisateur et/ou externes.\nDans un SPA, nous ne pouvons plus compter sur des rechargements entiers d‚Äôune page web pour garder une interface synchronis√©e et coh√©rente.</p>\n<h2>L‚Äôid√©e derri√®re React</h2>\n<p>La solution de React est de d√©crire ‚Äú√† quoi‚Äù l‚Äôapplication doit ressembler √† n‚Äôimporte quel instant donn√© ‚Üí construction de\nl‚Äô<em>UI</em> de mani√®re <strong>d√©clarative</strong>. Ce fonctionnement nous donne l‚Äôimpression que React redessine enti√®rement l‚Äôinterface √† chaque <em>update</em>\n(uniquement une impression ‚Üí cf DOM virtuel) Cela rend la conception et le d√©veloppement d‚Äôapplication consid√©rablement plus simple et nous permet\nde garder tr√®s facilement l‚Äôinterface √† jour avec un mod√®le de donn√©es.  L‚Äô√©laboration de ces interfaces se fait √† base de <strong>composants React</strong>.</p>\n<p>On pourrait assimiler un composant React √† une <strong>fonction</strong>.\nC‚Äôest d‚Äôailleurs une des 2 mani√®res possibles d‚Äô√©crire une composant React.</p>\n<p>L‚ÄôAPI des composants est tr√®s simple. Un composant <em>peut</em> poss√©der :</p>\n<ul>\n<li>un <strong>state</strong></li>\n<li>des propri√©t√©s : les donn√©es d‚Äôentr√©es du composant ‚Üí <strong>props</strong></li>\n<li>Une m√©thode <strong>render</strong> charg√©e du rendu du composant, appel√©e\nlorsque son <em>state</em> ou une de ses <em>props</em> changent.</li>\n<li>Des m√©thodes li√©es au <strong>cycle de vie</strong> du composant <code class=\"language-text\">componentDidMount</code>,\n<code class=\"language-text\">componentWillReceiveProps</code> etc‚Ä¶)</li>\n</ul>\n<h3>√âcriture avec les classes ES6</h3>\n<p>Ci-dessous un composant React ayant pour seule vocation d‚Äôafficher la propri√©t√© <em>user</em>.\nSi <em>user</em> change, React redessine la partie du composant ayant chang√©.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Bonjour</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Bonjour </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>√âcriture sous forme de fonction</h3>\n<p>Ce composant peut aussi √™tre √©crit sous la forme d‚Äôune fonction appel√©e <strong><del>Stateless</del> functional component</strong>. </p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Bonjour</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Bonjour </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Ce type de composant ne poss√®de <del>pas de <em>state</em></del> (cf. <a href=\"https://reactjs.org/docs/hooks-intro.html\">Hooks</a>) <strong>pas d‚Äôinstance ni\nde m√©thodes li√©es au cycle de vie</strong> d‚Äôun composant React. Il ne s‚Äôagit que d‚Äôune\nsimple fonction retournant un r√©sultat en fonction de ses arguments (les <em>props</em>)\nCette √©criture √©tant plus concise, elle est √† privil√©gier dans la mesure du possible.</p>\n<h3>Dessiner un composant dans un n≈ìud du DOM</h3>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Bonjour</span> <span class=\"token attr-name\">user</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>Vincent<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Pour dessiner le composant dans le DOM il suffit d‚Äôappeler\nla m√©thode <code class=\"language-text\">ReactDOM.render</code> avec ledit Composant et le n≈ìud du DOM o√π\nl‚Äôon souhaite le dessiner.</p>\n<h3>JSX</h3>\n<p>Le code ‚ÄúXML like‚Äù que retourne la m√©thode <em>render</em> s‚Äôappelle du <strong>JSX</strong>\net est un sucre syntaxique permettant de cr√©er les n≈ìuds React.\nL‚Äôutilisation du JSX n‚Äôest pas obligatoire. Voici la correspondance du\ncode JSX :</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Bonjour</span> <span class=\"token attr-name\">user</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>Vincent<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>Avec le code javascript √©quivalent :</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Bonjour'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  user<span class=\"token punctuation\">:</span> <span class=\"token string\">'Vincent'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<!-- ## On parle de container ? -->\n<!--  -->\n<!-- D'un point de vue architectural, nous pouvons tr√®s vite distinguer deux types de composants. -->\n<!-- Redux (cf : suite de l'article) parle de **container component** (ou *smart component*) et de -->\n<!-- **presentational component** (ou *dumb component*) -->\n<!-- Si l'on se rapportait √† une architecture _MVC_ plus traditionnelle,  -->\n<!-- le premier correspondrait au **C**ontrolleur et le deuxi√®me √† la **V**ue. -->\n<!-- **On s√©pare donc les composants responsables de la logique m√©tier/orchestration des actions, de ceux reponsables de la vue** -->\n<!--  -->\n<!-- ### Exemples -->\n<!-- Consid√©rons un composant qui affiche une liste de pistes (_tracks_) provenant d'une api. -->\n<!--  -->\n<!-- Le code ci-dessous est **moyen** üëø, en effet un m√™me composant **ne devrait pas** √™tre responsable √† la fois : -->\n<!-- - d'aller chercher les donn√©es de l'api et potentiellement les transformer   -->\n<!-- - d'afficher et mettre en forme ces donn√©es  -->\n<!--  -->\n<!-- Ce manque de s√©paration entre la vue et la logique m√©tier peut tr√®s vite rendre le code difficile √† maintenir lorsque ce dernier grossit. -->\n<!--  -->\n<!-- #### ‚úò Un \"mauvais\" composant : -->\n<!-- ```jsx -->\n<!-- class TrackList extends React.Component { -->\n<!--   state = { tracks: [] } -->\n<!--  -->\n<!--   componentDidMount() { -->\n<!--     axios.get('/tracks') -->\n<!--       .then(response => response.data) -->\n<!--       .then(tracks => this.setState({ tracks })) -->\n<!--       .catch(handleError); -->\n<!--   } -->\n<!--  -->\n<!--   render() { -->\n<!--     return ( -->\n<!--       <ul> -->\n<!--         {this.state.tracks.map(track => ( -->\n<!--           <li>{track}</li> -->\n<!--         ))} -->\n<!--       </ul> -->\n<!--     ) -->\n<!--   } -->\n<!-- } -->\n<!-- ``` -->\n<!--  -->\n<!-- Nous pouvons le s√©parer en 2 composants, le premier √©tant un composant \"container\" et le deuxi√®me un composant visuel. -->\n<!--  -->\n<!-- #### ‚úî Composant _Container_ : -->\n<!--  -->\n<!-- ```jsx -->\n<!-- // LOgic is here!!  -->\n<!-- // we have completely separated our logic and our view -->\n<!-- class TrackListContainer extends React.Component { -->\n<!--   state = { tracks: [] } -->\n<!--  -->\n<!--   componentDidMount() { -->\n<!--     axios.get('/tracks') -->\n<!--       .then(response => response.data) -->\n<!--       .then(tracks => this.setState({ tracks })) -->\n<!--       .catch(handleError); -->\n<!--   } -->\n<!--  -->\n<!--   render() { -->\n<!--     // This is our view  -->\n<!--     // and the `tracks` props is like our ViewModel  -->\n<!--     return <TrackList tracks={this.state.tracks} /> -->\n<!--   } -->\n<!-- } -->\n<!-- ``` -->\n<!--  -->\n<!--  -->\n<!-- #### ‚úî Composant _Presentational_ :  -->\n<!-- ```jsx -->\n<!-- // here is our view -->\n<!-- const TrackList = ({ tracks }) => ( -->\n<!--   <ul> -->\n<!--     {this.state.tracks.map(track => ( -->\n<!--       <li>{track}</li> -->\n<!--     ))} -->\n<!--   </ul> -->\n<!-- ) -->\n<!-- ``` -->\n<h2>DOM Virtuel</h2>\n<p>Lorsque nous √©crivons un composant React, nous d√©crivons √† quoi l‚ÄôUI ressemble en fonction des <em>props</em>.\nM√™me si React donne le sentiment au d√©veloppeur de repeindre enti√®rement le DOM √† chaque <em>update</em>, il impl√©mente, en r√©alit√©, un DOM virtuel qui est une repr√©sentation interne en javascript du DOM.\nVoici un sch√©ma illustrant le processus :</p>\n<figure>\n\t<img src=\"/react_batch-da50ac19fb6613cef197534adab4bda5.svg\" width=\"600\">\n\t<figcaption> React et son DOM virtuel</figcaption>\n</figure>\n<p>Lorsque le <span style=\"color: #D32F2F\">mod√®le de donn√©es change</span> la m√©thode <em>render</em> du composant renvoie\nun objet correspondant √† la repr√©sentation interne du DOM virtuel.\nReact compare ensuite ce nouveau DOM virtuel avec le pr√©c√©dent\n(algorithme de diff interne), et met √† jour le <em>vrai DOM</em> en appliquant un s√©rie d‚Äôop√©rations\noptimis√©es. Ce DOM virtuel permet donc d‚Äôoptimiser les acc√®s au ‚Äúvrai DOM‚Äù, les modifications sont appliqu√©es\nen une fois.</p>\n<h3>R√©f√©rences</h3>\n<ul>\n<li><em>React</em> - https¬†://facebook.github.io/react</li>\n</ul>","frontmatter":{"title":"Introduction √† React","date":"December 06, 2016","spoiler":"Une belle id√©e","thumbnail":null},"fields":{"slug":"/react-intro/"}}},"pageContext":{"slug":"/react-intro/","previous":{"fields":{"slug":"/hello-world/"},"frontmatter":{"title":"Hello World","draft":null}},"next":{"fields":{"slug":"/redux-intro/"},"frontmatter":{"title":"Architecture Redux","draft":null}}}}