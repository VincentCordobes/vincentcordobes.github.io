{"data":{"site":{"siteMetadata":{"title":"Vincent's page","author":"Vincent Cordobes"}},"markdownRemark":{"id":"2db1f4ed-e3b1-57e0-8cae-bd16730d845d","html":"<p>React est une bibliothÃ¨que javascript permettant de <strong>construire des interfaces graphiques composables</strong>. </p>\n<p>La modÃ©lisation des interfaces graphiques dâ€™une application au cours du temps est un sujet complexe. Il est, en effet, difficile de suivre lâ€™Ã©tat dâ€™une application, aprÃ¨s une sÃ©rie dâ€™interactions utilisateur et/ou externes.\nDans un SPA, nous ne pouvons plus compter sur des rechargements entiers dâ€™une page web pour garder une interface synchronisÃ©e et cohÃ©rente.</p>\n<h2>Lâ€™idÃ©e derriÃ¨re React</h2>\n<p>La solution de React est de dÃ©crire â€œÃ  quoiâ€ lâ€™application doit ressembler Ã  nâ€™importe quel instant donnÃ© â†’ construction de\nlâ€™<em>UI</em> de maniÃ¨re <strong>dÃ©clarative</strong>. Ce fonctionnement nous donne lâ€™impression que React redessine entiÃ¨rement lâ€™interface Ã  chaque <em>update</em>\n(uniquement une impression â†’ cf DOM virtuel) Cela rend la conception et le dÃ©veloppement dâ€™application considÃ©rablement plus simple et nous permet\nde garder trÃ¨s facilement lâ€™interface Ã  jour avec un modÃ¨le de donnÃ©es.  Lâ€™Ã©laboration de ces interfaces se fait Ã  base de <strong>composants React</strong>.</p>\n<p>On pourrait assimiler un composant React Ã  une <strong>fonction</strong>.\nCâ€™est dâ€™ailleurs une des 2 maniÃ¨res possibles dâ€™Ã©crire une composant React.</p>\n<p>Lâ€™API des composants est trÃ¨s simple. Un composant <em>peut</em> possÃ©der :</p>\n<ul>\n<li>un <strong>state</strong></li>\n<li>des propriÃ©tÃ©s : les donnÃ©es dâ€™entrÃ©es du composant â†’ <strong>props</strong></li>\n<li>Une mÃ©thode <strong>render</strong> chargÃ©e du rendu du composant, appelÃ©e\nlorsque son <em>state</em> ou une de ses <em>props</em> changent.</li>\n<li>Des mÃ©thodes liÃ©es au <strong>cycle de vie</strong> du composant <code class=\"language-text\">componentDidMount</code>,\n<code class=\"language-text\">componentWillReceiveProps</code> etcâ€¦)</li>\n</ul>\n<h3>Ã‰criture avec les classes ES6</h3>\n<p>Ci-dessous un composant React ayant pour seule vocation dâ€™afficher la propriÃ©tÃ© <em>user</em>.\nSi <em>user</em> change, React redessine la partie du composant ayant changÃ©.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Bonjour</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Bonjour </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3>Ã‰criture sous forme de fonction</h3>\n<p>Ce composant peut aussi Ãªtre Ã©crit sous la forme dâ€™une fonction appelÃ©e <strong>Stateless functional component</strong>. </p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Bonjour</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Bonjour </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>user<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Ce type de composant <strong>ne possÃ¨de ~pas de <em>state</em>~ (plus vrai au jour dâ€™aujourdâ€™hui 2019 avec les <a href=\"https://reactjs.org/docs/hooks-intro.html\">Hooks</a><em>Hooks</em> ), pas dâ€™instance ni de mÃ©thodes liÃ©es au cycle de vie</strong> dâ€™un composant React. Il ne sâ€™agit que dâ€™une\nsimple fonction retournant un rÃ©sultat en fonction de ses arguments (les <em>props</em>)\nCette Ã©criture Ã©tant plus concise, elle est Ã  privilÃ©gier dans la mesure du possible.</p>\n<h3>Dessiner un composant dans un nÅ“ud du DOM</h3>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\">ReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Bonjour</span> <span class=\"token attr-name\">user</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>Vincent<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'root'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Pour dessiner le composant dans le DOM il suffit dâ€™appeler\nla mÃ©thode <code class=\"language-text\">ReactDOM.render</code> avec ledit Composant et le nÅ“ud du DOM oÃ¹\nlâ€™on souhaite le dessiner.</p>\n<h3>JSX</h3>\n<p>Le code â€œXML likeâ€ que retourne la mÃ©thode <em>render</em> sâ€™appelle du <strong>JSX</strong>\net est un sucre syntaxique permettant de crÃ©er les nÅ“uds React.\nLâ€™utilisation du JSX nâ€™est pas obligatoire. Voici la correspondance du\ncode JSX :</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Bonjour</span> <span class=\"token attr-name\">user</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>Vincent<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Avec le code javascript Ã©quivalent :</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\">React<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Bonjour'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  user<span class=\"token punctuation\">:</span> <span class=\"token string\">'Vincent'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h2>Distinguer 2 types de composants React</h2>\n<p>Dâ€™un point de vue architectural, nous pouvons trÃ¨s vite distinguer deux types de composants.\nRedux (cf : suite de lâ€™article) parle de <strong>container component</strong> (ou <em>smart component</em>) et de\n<strong>presentational component</strong> (ou <em>dumb component</em>)\nSi lâ€™on se rapportait Ã  une architecture <em>MVC</em> plus traditionnelle,\nle premier correspondrait au <strong>C</strong>ontrolleur et le deuxiÃ¨me Ã  la <strong>V</strong>ue.\n<strong>On sÃ©pare donc les composants responsables de la logique mÃ©tier/orchestration des actions, de ceux reponsables de la vue</strong></p>\n<h3>Exemple</h3>\n<p>ConsidÃ©rons un composant qui affiche une liste de pistes (<em>tracks</em>) provenant dâ€™une api.</p>\n<p>Le code ci-dessous est <strong>moyen</strong> ğŸ‘¿, en effet un mÃªme composant <strong>ne devrait pas</strong> Ãªtre responsable Ã  la fois :</p>\n<ul>\n<li>dâ€™aller chercher les donnÃ©es de lâ€™api et potentiellement les transformer  </li>\n<li>dâ€™afficher et mettre en forme ces donnÃ©es </li>\n</ul>\n<p>Ce manque de sÃ©paration entre la vue et la logique mÃ©tier peut trÃ¨s vite rendre le code difficile Ã  maintenir lorsque ce dernier grossit.</p>\n<h4>âœ˜ Un â€œmauvaisâ€ composant :</h4>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">TrackList</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> tracks<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    axios<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/tracks'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>response <span class=\"token operator\">=></span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>tracks <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> tracks <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>handleError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>tracks<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>track <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>track<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Nous pouvons le sÃ©parer en 2 composants, le premier Ã©tant un composant â€œcontainerâ€ et le deuxiÃ¨me un composant visuel.</p>\n<h4>âœ” Composant <em>Container</em> :</h4>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token comment\">// LOgic is here!! </span>\n<span class=\"token comment\">// we have completely separated our logic and our view</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">TrackListContainer</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> tracks<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    axios<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/tracks'</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>response <span class=\"token operator\">=></span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>tracks <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> tracks <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>handleError<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// This is our view </span>\n    <span class=\"token comment\">// and the `tracks` props is like our ViewModel </span>\n    <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>TrackList</span> <span class=\"token attr-name\">tracks</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>tracks<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>âœ” Composant <em>Presentational</em> :</h4>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-jsx line-numbers\"><code class=\"language-jsx\"><span class=\"token comment\">// here is our view</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">TrackList</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> tracks <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>tracks<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>track <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>track<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>DOM Virtuel</h2>\n<p>Lorsque nous Ã©crivons un composant React, nous dÃ©crivons Ã  quoi lâ€™UI ressemble en fonction des <em>props</em>.\nMÃªme si React donne le sentiment au dÃ©veloppeur de repeindre entiÃ¨rement le DOM Ã  chaque <em>update</em>,\nil implÃ©mente, en rÃ©alitÃ©, ~un DOM virtuel~ une reprÃ©sentation like du DOM.\nVoici un schÃ©ma illustrant le processus :</p>\n<p align=\"center\"><img src=\"./react_batch.svg\" width=\"600\"></p>\n<h6 align=\"center\">React et son DOM virtuel</h6>\n<p>Lorsque le <span style=\"color: #D32F2F\">modÃ¨le de donnÃ©es change</span> la mÃ©thode <em>render</em> du composant renvoie\nun objet correspondant Ã  la reprÃ©sentation interne du DOM virtuel.\nReact compare ensuite ce nouveau DOM virtuel avec le prÃ©cÃ©dent\n(algorithme de diff interne), et met Ã  jour le <em>vrai DOM</em> en appliquant un sÃ©rie dâ€™opÃ©rations\noptimisÃ©es. Ce DOM virtuel permet donc dâ€™optimiser les accÃ¨s au â€œvrai DOMâ€, les modifications sont appliquÃ©es\nen une fois.</p>","frontmatter":{"title":"React - intro","date":"December 06, 2016","spoiler":"Une belle idÃ©e"},"fields":{"slug":"/react-intro/"}}},"pageContext":{"slug":"/react-intro/","previous":{"fields":{"slug":"/hello-world/"},"frontmatter":{"title":"Hello World"}},"next":{"fields":{"slug":"/git-rebase/"},"frontmatter":{"title":"Rebase - rewrite the past in fewer steps"}}}}